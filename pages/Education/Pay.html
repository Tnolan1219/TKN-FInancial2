<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Education ‚Äî Pay & Compensation | Mil‚ÄëFi</title>
  <meta name="description" content="Understand military base pay, allowances (BAH, BAS, COLA), special & incentive pays, and retirement basics (High‚Äë3 vs BRS)." />
  <!-- Global education styles (provided by you) -->
  <link rel="stylesheet" href="edustyle.css" />
</head>
<body class="page-pay">
  <!-- Header / Top Nav -->
  <header class="site-header" role="banner">
    <div class="container header-inner">
      <a class="brand" href="/index.html" aria-label="Mil‚ÄëFi Home">üõ°Ô∏è Mil‚ÄëFi</a>
      <nav class="edu-nav" aria-label="Education primary">
        <a class="tab active" href="pay.html" aria-current="page">Pay & Compensation</a>
        <a class="tab" href="housing.html">Housing & VA Loan</a>
        <a class="tab" href="education-funding.html">Education Funding</a>
        <a class="tab" href="retirement.html">TSP & Retirement</a>
        <a class="tab" href="credit-banking.html">Credit & Banking</a>
        <a class="tab" href="loans-debt.html">Loans & Debt</a>
        <a class="tab" href="va-benefits.html">VA Benefits</a>
        <a class="tab" href="taxes.html">Taxes</a>
        <a class="tab" href="family-transition.html">Family & Transition</a>
        <a class="tab" href="guard-reserve.html">Guard/Reserve</a>
        <a class="tab" href="calculators.html">Calculators</a>
        <a class="tab" href="glossary.html">Glossary</a>
        <a class="tab" href="faq.html">FAQ</a>
      </nav>
    </div>
  </header>

  <main id="content" class="container" role="main">
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <a href="education-index.html">Education</a>
      <span aria-hidden="true">‚Ä∫</span>
      <strong>Pay & Compensation</strong>
    </nav>

    <header class="page-head">
      <h1>Pay & Compensation</h1>
      <p class="lede">Your comprehensive guide to <strong>Base Pay</strong>, <strong>Allowances</strong> (BAH/BAS/COLA), <strong>Special & Incentive Pays</strong>, and <strong>Retirement basics</strong> (Legacy High‚Äë3 vs. BRS). Interact with the tools and charts below to learn how each piece affects your take‚Äëhome.</p>
      <p class="meta">Last updated: <time datetime="2025-09-06">September 6, 2025</time></p>
    </header>

    <!-- Local TOC -->
    <aside class="toc" aria-label="On this page">
      <h2 class="toc-title">On this page</h2>
      <ol>
        <li><a href="#base-pay">Base Pay</a></li>
        <li><a href="#allowances">Allowances (BAH, BAS, COLA)</a></li>
        <li><a href="#special-pays">Special & Incentive Pays & Bonuses</a></li>
        <li><a href="#retirement">Retirement Basics (High‚Äë3 vs. BRS)</a></li>
        <li><a href="#faq">FAQ & Glossary</a></li>
      </ol>
    </aside>

    <!-- 1) Base Pay -->
    <section id="base-pay" class="edu-section" aria-labelledby="base-pay-h2">
      <h2 id="base-pay-h2">1) Base Pay (what it is & where to verify)</h2>
      <p>Base pay is your foundational salary (LES line: <strong>BASIC PAY</strong>). It increases with <em>rank</em> and <em>years of service (YOS)</em> and is set by law. Official tables are published by DFAS/DoD and typically update around January 1. Always verify current tables before budgeting.</p>

      <div class="grid cols-2">
        <div class="card">
          <div class="head">Interactive: Estimate Monthly Base Pay (demo)</div>
          <div class="grid cols-2">
            <label>Grade
              <select id="bp-grade">
                <optgroup label="Enlisted">
                  <option>E-1</option><option>E-2</option><option>E-3</option><option>E-4</option><option>E-5</option><option>E-6</option><option>E-7</option><option>E-8</option><option>E-9</option>
                </optgroup>
                <optgroup label="Warrant">
                  <option>W-1</option><option>W-2</option><option>W-3</option><option>W-4</option><option>W-5</option>
                </optgroup>
                <optgroup label="Officer">
                  <option>O-1</option><option>O-2</option><option>O-3</option><option>O-4</option><option>O-5</option><option>O-6</option><option>O-7</option><option>O-8</option><option>O-9</option><option>O-10</option>
                </optgroup>
              </select>
            </label>
            <label>Years of Service
              <input id="bp-yos" type="range" min="0" max="40" value="4" />
            </label>
          </div>
          <p class="muted" id="bp-yos-val">YOS: 4</p>
          <div class="grid cols-2" style="align-items:start">
            <button class="btn primary" id="bp-calc">Estimate</button>
            <div class="card" id="bp-result"><div class="head">Result</div><p class="muted">‚Äî</p></div>
          </div>
          <p class="muted" style="margin-top:8px">Demo uses a small placeholder table for offline learning. Verify real numbers with DFAS.</p>
          <div class="cta-row">
            <a class="btn" href="https://www.dfas.mil/militarymembers/payentitlements/Pay-Tables/" target="_blank" rel="noopener">View DFAS Pay Tables</a>
            <a class="btn ghost" href="https://militarypay.defense.gov/Pay/" target="_blank" rel="noopener">DoD Pay Overview</a>
          </div>
        </div>

        <div class="card">
          <div class="head">Chart: Base Pay Progression (demo)</div>
          <canvas id="bp-chart" width="560" height="280" aria-label="Line chart of estimated base pay over years of service" role="img"></canvas>
          <p class="muted" style="margin-top:8px">Shows a simple progression for the selected grade across YOS buckets (demo data).</p>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <div class="head">What to check on your LES</div>
        <ul style="margin:0; padding-left:18px">
          <li>Rank/grade and YOS are correct</li>
          <li>BAH status (with/without dependents) correct</li>
          <li>Allotments/deductions make sense</li>
          <li>TSP contribution % and type (Traditional vs Roth)</li>
        </ul>
      </div>
    </section>

    <hr class="divider" />

    <!-- 2) Allowances -->
    <section id="allowances" class="edu-section" aria-labelledby="allowances-h2">
      <h2 id="allowances-h2">2) Allowances (tax‚Äëadvantaged pieces that increase take‚Äëhome)</h2>

      <div class="grid cols-3">
        <article class="card" aria-labelledby="bah-h3">
          <h3 id="bah-h3">BAH ‚Äî Basic Allowance for Housing</h3>
          <p>Paid when adequate government quarters are not provided. Your rate depends on duty ZIP, grade, and dependent status. Derived from local median rent/utilities and refreshed annually.</p>
          <label>ZIP (duty location)
            <input id="bah-zip" inputmode="numeric" placeholder="e.g., 21012" />
          </label>
          <div class="grid cols-2">
            <label>Grade
              <select id="bah-grade"><option>E-4</option><option>E-5</option><option>E-6</option><option>O-1</option><option>O-3</option></select>
            </label>
            <label>Status
              <select id="bah-dep"><option value="with">With Dependents</option><option value="without">Without Dependents</option></select>
            </label>
          </div>
          <div class="grid cols-2" style="align-items:start">
            <button class="btn primary" id="bah-calc">Estimate</button>
            <div class="card" id="bah-result"><div class="head">Result</div><p class="muted">‚Äî</p></div>
          </div>
          <div class="cta-row" style="margin-top:8px">
            <a class="btn" href="https://www.travel.dod.mil/Allowances/Basic-Allowance-for-Housing/BAH-Rate-Lookup/" target="_blank" rel="noopener">DTMO BAH Calculator</a>
            <a class="btn ghost" href="https://militarypay.defense.gov/Pay/Allowances/bah/" target="_blank" rel="noopener">BAH Policy</a>
          </div>
        </article>

        <article class="card" aria-labelledby="bas-h3">
          <h3 id="bas-h3">BAS ‚Äî Basic Allowance for Subsistence</h3>
          <p>Tax‚Äëfree food allowance. Flat rate differs for enlisted and officers; usually adjusted annually.</p>
          <table aria-label="Example BAS (placeholder)">
            <thead><tr><th>Category</th><th>Example Monthly (2025)</th></tr></thead>
            <tbody><tr><td>Enlisted</td><td>$460</td></tr><tr><td>Officer</td><td>$320</td></tr></tbody>
          </table>
          <a class="btn" style="margin-top:8px" href="https://www.dfas.mil/militarymembers/payentitlements/Pay-Tables/" target="_blank" rel="noopener">Check DFAS</a>
        </article>

        <article class="card" aria-labelledby="cola-h3">
          <h3 id="cola-h3">COLA ‚Äî Cost of Living Allowance</h3>
          <p>Offsets higher living costs in certain CONUS/OCONUS locations. Amounts vary and may change during the year.</p>
          <div class="grid cols-2">
            <label>Location<select id="cola-loc"><option>CONUS (example)</option><option>OCONUS (example)</option></select></label>
            <label>Dependents?<select id="cola-dep"><option>With</option><option>Without</option></select></label>
          </div>
          <div class="grid cols-2" style="align-items:start">
            <button class="btn" id="cola-calc">Show Example</button>
            <div class="card" id="cola-result"><div class="head">Result</div><p class="muted">‚Äî</p></div>
          </div>
          <div class="cta-row" style="margin-top:8px">
            <a class="btn" href="https://www.travel.dod.mil/Allowances/CONUS-Cost-of-Living-Allowance/" target="_blank" rel="noopener">CONUS COLA</a>
            <a class="btn ghost" href="https://www.travel.dod.mil/Allowances/Overseas-Cost-of-Living-Allowance/" target="_blank" rel="noopener">OCONUS COLA</a>
          </div>
        </article>
      </div>

      <div class="card" style="margin-top:12px">
        <div class="head">Chart: Take‚ÄëHome Composition (demo)</div>
        <canvas id="comp-chart" width="900" height="320" aria-label="Stacked bar chart of base pay + allowances composition" role="img"></canvas>
        <p class="muted" style="margin-top:8px">Toggle inputs above and click <em>Refresh charts</em> to visualize how allowances change your total monthly compensation (demo math).</p>
        <button class="btn" id="refresh-charts" style="margin-top:8px">Refresh charts</button>
      </div>

      <p class="next-step"><strong>What to do next:</strong> Look up BAH and COLA for your current or next duty station with DTMO tools; confirm BAS on DFAS.</p>
    </section>

    <hr class="divider" />

    <!-- 3) Special & Incentive Pays -->
    <section id="special-pays" class="edu-section" aria-labelledby="special-pays-h2">
      <h2 id="special-pays-h2">3) Special & Incentive Pays & Bonuses</h2>
      <p>There are many pays tied to special skills or duty (aviation, sea, hazardous, language, medical) and bonuses (enlistment/reenlistment). Each has unique eligibility and start/stop rules. Confirm details with your finance office before relying on them.</p>

      <div class="chips" role="group" aria-label="Filter pay categories">
        <button class="chip" data-tag="aviation">Aviation</button>
        <button class="chip" data-tag="sea">Sea</button>
        <button class="chip" data-tag="hazard">Hazard</button>
        <button class="chip" data-tag="language">Language</button>
        <button class="chip" data-tag="medical">Medical</button>
        <button class="chip" data-tag="bonus">Re/Enlist Bonus</button>
      </div>

      <div class="acc" id="pay-acc">
        <div class="acc-item" data-tags="aviation"><button class="acc-btn">Aviation Incentive Pay</button><div class="acc-panel"><p>For qualified aviation professionals; amounts vary by rating, service, and gate/YOS. Requires current orders and qualifications.</p><a class="btn ghost" href="https://militarypay.defense.gov/Pay/Special-and-Incentive-Pays/" target="_blank" rel="noopener">DoD S&I Pays</a></div></div>
        <div class="acc-item" data-tags="sea"><button class="acc-btn">Sea Pay</button><div class="acc-panel"><p>For qualifying sea duty on designated vessels; scales by pay grade and cumulative sea time.</p><a class="btn ghost" href="https://militarypay.defense.gov/Pay/Special-and-Incentive-Pays/" target="_blank" rel="noopener">DoD S&I Pays</a></div></div>
        <div class="acc-item" data-tags="hazard"><button class="acc-btn">Hazardous Duty Pay</button><div class="acc-panel"><p>For duty involving specific hazards (e.g., jump/demolition). Requires start/stop documentation and currency.</p><a class="btn ghost" href="https://militarypay.defense.gov/Pay/Special-and-Incentive-Pays/" target="_blank" rel="noopener">DoD S&I Pays</a></div></div>
        <div class="acc-item" data-tags="language"><button class="acc-btn">Foreign Language Proficiency Pay</button><div class="acc-panel"><p>Bonuses for tested languages/levels (DLPT/DLRPT). Amount depends on proficiency and language category.</p><a class="btn ghost" href="https://militarypay.defense.gov/Pay/Special-and-Incentive-Pays/" target="_blank" rel="noopener">DoD S&I Pays</a></div></div>
        <div class="acc-item" data-tags="medical"><button class="acc-btn">Medical Incentive/Special Pays</button><div class="acc-panel"><p>For qualifying medical professionals (e.g., HPSP, accession/retention bonuses, board‚Äëcertification pays). Terms vary by service and specialty.</p><a class="btn ghost" href="https://militarypay.defense.gov/Pay/Special-and-Incentive-Pays/" target="_blank" rel="noopener">DoD S&I Pays</a></div></div>
        <div class="acc-item" data-tags="bonus"><button class="acc-btn">Enlistment/Reenlistment Bonuses</button><div class="acc-panel"><p>Availability and amounts depend on manning and specialty; paid per contract and policy.</p><a class="btn ghost" href="https://militarypay.defense.gov/Pay/Special-and-Incentive-Pays/" target="_blank" rel="noopener">DoD S&I Pays</a></div></div>
      </div>
    </section>

    <hr class="divider" />

    <!-- 4) Retirement Basics -->
    <section id="retirement" class="edu-section" aria-labelledby="retirement-h2">
      <h2 id="retirement-h2">4) Retirement Basics (Legacy High‚Äë3 vs. BRS)</h2>

      <div class="grid cols-2">
        <div class="card">
          <div class="head">High‚Äë3 Pension ‚Äî quick demo</div>
          <div class="grid cols-2">
            <label>Years of Service (YOS)
              <input id="h3-yos" type="range" min="0" max="40" value="20" />
            </label>
            <label>High‚Äë3 Average Base Pay ($/mo)
              <input id="h3-high" type="number" min="0" value="7000" />
            </label>
          </div>
          <p class="muted" id="h3-yos-val">YOS: 20</p>
          <div class="grid cols-2" style="align-items:start">
            <button class="btn primary" id="h3-calc">Estimate</button>
            <div class="card" id="h3-result"><div class="head">Result</div><p class="muted">‚Äî</p></div>
          </div>
          <p class="muted" style="margin-top:8px">Formula: <strong>2.5% √ó YOS √ó High‚Äë3</strong> (monthly). Taxes/deductions not included.</p>
        </div>

        <div class="card">
          <div class="head">BRS ‚Äî pension + DoD TSP (demo)</div>
          <div class="grid cols-2">
            <label>Years of Service (YOS)
              <input id="brs-yos" type="range" min="0" max="40" value="20" />
            </label>
            <label>High‚Äë3 Average Base Pay ($/mo)
              <input id="brs-high" type="number" min="0" value="7000" />
            </label>
            <label>Member TSP % (0‚Äì15)
              <input id="brs-mem" type="range" min="0" max="15" value="5" />
            </label>
            <label>Base Pay (for TSP) ($/mo)
              <input id="brs-base" type="number" min="0" value="5000" />
            </label>
          </div>
          <p class="muted" id="brs-mem-val">Member TSP: 5%</p>
          <div class="grid cols-2" style="align-items:start">
            <button class="btn" id="brs-calc">Estimate</button>
            <div class="card" id="brs-result"><div class="head">Result</div><p class="muted">‚Äî</p></div>
          </div>
          <p class="muted" style="margin-top:8px">Pension = <strong>2.0% √ó YOS √ó High‚Äë3</strong>. TSP = <strong>1% auto</strong> + up to <strong>4% match</strong> at 5% member contribution.</p>
        </div>
      </div>

      <div class="grid cols-2" style="margin-top:12px">
        <div class="card">
          <div class="head">Chart: Pension Comparison (demo)</div>
          <canvas id="ret-chart" width="560" height="280" aria-label="Bar chart comparing High-3 vs BRS monthly pension + DoD TSP" role="img"></canvas>
          <p class="muted" style="margin-top:8px">Compares estimated monthly High‚Äë3 vs BRS pension; BRS chart also shows DoD TSP contribution for the selected base pay and member % (demo math).</p>
        </div>
        <div class="card">
          <div class="head">Key Differences</div>
          <ul style="margin:0; padding-left:18px">
            <li>Multiplier: High‚Äë3 = 2.5% √ó YOS; BRS = 2.0% √ó YOS</li>
            <li>TSP: High‚Äë3 = none guaranteed; BRS = 1% auto + up to 4% match (at 5%)</li>
            <li>Continuation Pay: BRS only (mid‚Äëcareer, service‚Äëset ranges)</li>
            <li>Lump‚Äësum option at retirement: BRS optional</li>
          </ul>
          <div class="cta-row" style="margin-top:8px">
            <a class="btn" href="https://militarypay.defense.gov/BlendedRetirement/" target="_blank" rel="noopener">DoD: BRS</a>
            <a class="btn ghost" href="https://militarypay.defense.gov/Benefits/Retired-Pay/" target="_blank" rel="noopener">DoD: Retired Pay</a>
          </div>
        </div>
      </div>
    </section>

    <hr class="divider" />

    <section id="faq" class="edu-section" aria-labelledby="faq-h2">
      <h2 id="faq-h2">FAQ & Glossary</h2>
      <div class="acc" style="margin-top:8px">
        <div class="acc-item"><button class="acc-btn">Why is my BAH different than my friend‚Äôs?</button><div class="acc-panel"><p>BAH varies by duty ZIP, pay grade, and dependent status. Use your official duty ZIP in DTMO.</p></div></div>
        <div class="acc-item"><button class="acc-btn">How often do pay tables update?</button><div class="acc-panel"><p>Typically annually (around Jan 1), subject to Congress/DoD updates. Verify on DFAS.</p></div></div>
        <div class="acc-item"><button class="acc-btn">Does BAS change if I live on base?</button><div class="acc-panel"><p>BAS is generally a flat rate by status. Dining facility arrangements can affect how you experience the benefit‚Äîcheck local policy.</p></div></div>
        <div class="acc-item"><button class="acc-btn">What triggers start/stop on special pays?</button><div class="acc-panel"><p>Orders and qualification currency (e.g., flight/jump) typically control eligibility. Ensure admin routes changes promptly.</p></div></div>
      </div>
      <div class="grid cols-3" style="margin-top:12px">
        <div class="card"><div class="head">Glossary</div>
          <ul style="margin:0; padding-left:18px">
            <li><strong>LES</strong> ‚Äî Leave & Earnings Statement</li>
            <li><strong>YOS</strong> ‚Äî Years of Service</li>
            <li><strong>High‚Äë3</strong> ‚Äî Average of highest 36 months base pay</li>
            <li><strong>BRS</strong> ‚Äî Blended Retirement System</li>
            <li><strong>COLA</strong> ‚Äî Cost of Living Allowance</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="page-foot">
      <p class="disclaimer">Education only. Rates and policies change‚Äîalways verify with DFAS, DTMO, and your finance office.</p>
      <nav class="next-prev" aria-label="Next/previous in Education">
        <a class="btn ghost" href="education-index.html">‚Üê Education Home</a>
        <a class="btn" href="housing.html">Next: Housing & VA Loan ‚Üí</a>
      </nav>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>¬© <span id="year"></span> Mil‚ÄëFi. Education resources for servicemembers and families.</p>
    </div>
  </footer>

  <script>
    // --------------------------------------------------------
    // Small UI helpers (no external libs)
    // --------------------------------------------------------
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    document.getElementById('year').textContent = new Date().getFullYear();

    // Toggle accordions
    document.querySelectorAll('.acc').forEach(acc => {
      acc.addEventListener('click', (e) => {
        const btn = e.target.closest('.acc-btn');
        if (!btn) return;
        btn.parentElement.classList.toggle('open');
      });
    });

    // TOC active highlight
    (function(){
      const toc = document.querySelector('.toc');
      const links = toc ? Array.from(toc.querySelectorAll('a[href^="#"]')) : [];
      const secs = links.map(a => document.getElementById(a.getAttribute('href').slice(1))).filter(Boolean);
      if ('IntersectionObserver' in window && secs.length){
        const byId = new Map(links.map(a => [a.getAttribute('href').slice(1), a]));
        const obs = new IntersectionObserver((entries)=>{
          entries.forEach(entry => {
            const l = byId.get(entry.target.id);
            if (!l) return;
            if (entry.isIntersecting){ links.forEach(x => x.classList.remove('is-active')); l.classList.add('is-active'); }
          });
        }, { rootMargin:'-40% 0px -55% 0px', threshold:0.01 });
        secs.forEach(s => obs.observe(s));
      }
    })();

    // --------------------------------------------------------
    // Demo data + calculators (placeholder math for offline use)
    // --------------------------------------------------------
    const SAMPLE_BASE_PAY = {
      'E-1':[2000,2100,2200,2300,2400,2500], 'E-2':[2150,2250,2350,2450,2550,2650],
      'E-3':[2300,2450,2600,2750,2900,3050], 'E-4':[2700,2850,3000,3150,3300,3450],
      'E-5':[3200,3400,3600,3800,4000,4200], 'E-6':[3700,3950,4200,4450,4700,4950],
      'E-7':[4200,4450,4700,4950,5200,5450], 'E-8':[4900,5150,5400,5650,5900,6150],
      'E-9':[5700,6000,6300,6600,6900,7200],
      'W-1':[4200,4450,4700,4950,5200,5450], 'W-2':[4700,4950,5200,5450,5700,5950],
      'W-3':[5500,5800,6100,6400,6700,7000], 'W-4':[6400,6700,7000,7300,7600,7900], 'W-5':[7600,7950,8300,8650,9000,9350],
      'O-1':[3800,4000,4200,4400,4600,4800], 'O-2':[4600,4850,5100,5350,5600,5850],
      'O-3':[6000,6300,6600,6900,7200,7500], 'O-4':[7200,7500,7800,8100,8400,8700],
      'O-5':[8300,8650,9000,9350,9700,10050], 'O-6':[9200,9600,10000,10400,10800,11200],
      'O-7':[10500,11000,11500,12000,12500,13000]
    };
    const YOS_BUCKET = (y)=> y<2?0:y<4?1:y<6?2:y<8?3:y<10?4:5;

    const bpGrade = document.getElementById('bp-grade');
    const bpYos = document.getElementById('bp-yos');
    const bpYosVal = document.getElementById('bp-yos-val');
    const bpBtn = document.getElementById('bp-calc');
    const bpOut = document.querySelector('#bp-result p');
    bpYos.addEventListener('input', ()=>{ bpYosVal.textContent = `YOS: ${bpYos.value}`; });
    bpBtn.addEventListener('click', ()=>{
      const table = SAMPLE_BASE_PAY[bpGrade.value] || [3500,3700,3900,4100,4300,4500];
      const est = table[YOS_BUCKET(parseInt(bpYos.value,10))];
      bpOut.textContent = `Estimated Monthly Base Pay (demo): $${est.toLocaleString()}`;
      drawBasePayChart(bpGrade.value);
    });

    // BAH estimate (very rough placeholder)
    function bahEstimate(zip, grade, dep){
      const z = parseInt(String(zip).replace(/\D/g,''),10);
      if (!z || String(zip).length < 3) return 0;
      const base = 900 + (z % 600);
      const gradeBump = /O-/.test(grade)? 900 : /E-[5-9]/.test(grade)? 400 : /E-[34]/.test(grade)? 200 : 100;
      const depBump = dep==='with' ? 300 : 0;
      return Math.round((base+gradeBump+depBump)/10)*10;
    }
    const bahZip = document.getElementById('bah-zip');
    const bahGrade = document.getElementById('bah-grade');
    const bahDep = document.getElementById('bah-dep');
    const bahBtn = document.getElementById('bah-calc');
    const bahOut = document.querySelector('#bah-result p');
    bahBtn.addEventListener('click', ()=>{
      const est = bahEstimate(bahZip.value, bahGrade.value, bahDep.value);
      bahOut.textContent = est? `Demo estimate: ~$${est.toLocaleString()} / mo` : 'Enter a valid ZIP (3‚Äì5 digits)';
    });

    // COLA placeholder
    const colaLoc = document.getElementById('cola-loc');
    const colaDep = document.getElementById('cola-dep');
    const colaBtn = document.getElementById('cola-calc');
    const colaOut = document.querySelector('#cola-result p');
    colaBtn && colaBtn.addEventListener('click', ()=>{
      const amt = colaLoc.value.includes('OCONUS') ? (colaDep.value.includes('With')? 450: 320) : (colaDep.value.includes('With')? 120: 90);
      colaOut.textContent = `Demo example: ~$${amt} / mo`;
    });

    // --------------------------------------------------------
    // Charts (Canvas 2D) ‚Äî tiny helpers
    // --------------------------------------------------------
    function px(n){ return Math.round(n); }
    function drawAxes(ctx, w, h, pad){
      ctx.strokeStyle = 'rgba(255,255,255,.16)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(pad, h-pad);
      ctx.lineTo(w-pad, h-pad);
      ctx.moveTo(pad, h-pad);
      ctx.lineTo(pad, pad);
      ctx.stroke();
    }
    function drawGrid(ctx, w, h, pad){
      ctx.strokeStyle = 'rgba(255,255,255,.08)';
      ctx.lineWidth = 1;
      const rows = 4;
      for(let i=1;i<=rows;i++){
        const y = pad + ((h-2*pad) * i/rows);
        ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(w-pad, y); ctx.stroke();
      }
    }

    // Base Pay line chart by YOS buckets for the selected grade
    function drawBasePayChart(grade){
      const cvs = document.getElementById('bp-chart');
      if (!cvs) return;
      const ctx = cvs.getContext('2d');
      const w = cvs.width, h = cvs.height, pad = 36;
      ctx.clearRect(0,0,w,h);
      drawAxes(ctx,w,h,pad); drawGrid(ctx,w,h,pad);
      const vals = SAMPLE_BASE_PAY[grade] || [3500,3700,3900,4100,4300,4500];
      const max = Math.max(...vals) * 1.1;
      // Plot
      ctx.lineWidth = 2; ctx.strokeStyle = '#7aa2ff'; ctx.fillStyle = 'rgba(122,162,255,.2)';
      ctx.beginPath();
      vals.forEach((v,i)=>{
        const x = pad + i * ((w-2*pad)/(vals.length-1));
        const y = h - pad - (v/max)*(h-2*pad);
        if (i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.stroke();
      // Fill under line
      ctx.lineTo(w-pad, h-pad); ctx.lineTo(pad, h-pad); ctx.closePath(); ctx.fill();
      // X labels
      ctx.fillStyle = 'rgba(255,255,255,.7)'; ctx.font = '12px system-ui';
      const labels = ['<2','2‚Äì3','4‚Äì5','6‚Äì7','8‚Äì9','10+'];
      labels.forEach((t,i)=>{
        const x = pad + i * ((w-2*pad)/(labels.length-1));
        ctx.fillText(t, x-8, h-pad+16);
      });
    }

    // Composition stacked bar (Base / BAH / BAS / COLA)
    function drawCompChart(){
      const cvs = document.getElementById('comp-chart'); if(!cvs) return;
      const ctx = cvs.getContext('2d'); const w=cvs.width, h=cvs.height, pad=36;
      ctx.clearRect(0,0,w,h); drawAxes(ctx,w,h,pad); drawGrid(ctx,w,h,pad);
      // Gather demo numbers
      const grade = bpGrade.value; const yos = parseInt(bpYos.value,10);
      const baseArr = SAMPLE_BASE_PAY[grade] || [3500,3700,3900,4100,4300,4500];
      const base = baseArr[YOS_BUCKET(yos)];
      const bah = bahEstimate(bahZip.value||'21012', bahGrade.value||'E-4', bahDep.value||'with');
      const bas = (/O-/.test(grade)? 320: 460); // demo
      const cola = (colaLoc.value||'CONUS').includes('OCONUS') ? (colaDep.value.includes('With')? 450: 320) : (colaDep.value.includes('With')? 120: 90);
      const parts = [base, bah, bas, cola];
      const colors = ['#87a6ff','#60a5fa','#3ddc97','#ffd166'];
      const labels = ['Base','BAH','BAS','COLA'];
      const total = parts.reduce((a,b)=>a+b,0); const max = total*1.2;

      // Single stacked bar in middle
      const barW = 120; const x = (w-barW)/2; let y = h-pad;
      parts.forEach((val,i)=>{
        const height = (val/max)*(h-2*pad);
        y -= height; ctx.fillStyle = colors[i]; ctx.fillRect(x, y, barW, height);
      });
      // Legend + labels
      ctx.fillStyle = 'rgba(255,255,255,.85)'; ctx.font='12px system-ui';
      ctx.fillText(`Total (demo): $${Math.round(total).toLocaleString()}/mo`, x-40, pad-8);
      labels.forEach((t,i)=>{ ctx.fillStyle = colors[i]; ctx.fillRect(w-180, pad+ i*24, 12,12); ctx.fillStyle = 'rgba(255,255,255,.8)'; ctx.fillText(`${t}`, w-160, pad+ i*24 + 10); });
    }

    // Retirement comparison chart
    function drawRetChart(){
      const cvs = document.getElementById('ret-chart'); if(!cvs) return;
      const ctx = cvs.getContext('2d'); const w=cvs.width, h=cvs.height, pad=36;
      ctx.clearRect(0,0,w,h); drawAxes(ctx,w,h,pad); drawGrid(ctx,w,h,pad);
      const yos = +document.getElementById('h3-yos').value || 0;
      const high3 = +document.getElementById('h3-high').value || 0;
      const brsY = +document.getElementById('brs-yos').value || 0;
      const brsHigh = +document.getElementById('brs-high').value || 0;
      const memPct = Math.max(0, Math.min(15, +document.getElementById('brs-mem').value || 0));
      const base = +document.getElementById('brs-base').value || 0;
      const high3Pension = 0.025 * yos * high3;
      const brsPension = 0.02 * brsY * brsHigh;
      const dodPct = 0.01 + Math.min(0.04, memPct/100); // 1% auto + up to 4% match
      const dodMonthly = base * dodPct;
      // Bars
      const barW = 80; const gap = 40; const startX = pad + 40; const ground = h - pad;
      const max = Math.max(high3Pension, brsPension + dodMonthly) * 1.25 || 1;
      // High-3 bar
      let x = startX; let height = (high3Pension/max)*(h-2*pad);
      ctx.fillStyle = '#87a6ff'; ctx.fillRect(x, ground - height, barW, height);
      ctx.fillStyle = 'rgba(255,255,255,.8)'; ctx.font='12px system-ui'; ctx.fillText('High‚Äë3', x+10, ground+16);
      // BRS bar (stacked: pension + DoD TSP)
      x += barW + gap;
      const h1 = (brsPension/max)*(h-2*pad); const h2 = (dodMonthly/max)*(h-2*pad);
      ctx.fillStyle = '#60a5fa'; ctx.fillRect(x, ground - h1, barW, h1); // pension
      ctx.fillStyle = '#3ddc97'; ctx.fillRect(x, ground - h1 - h2, barW, h2); // DoD TSP
      ctx.fillStyle = 'rgba(255,255,255,.8)'; ctx.fillText('BRS', x+26, ground+16);
      // Legend
      ctx.fillStyle = '#87a6ff'; ctx.fillRect(w-190, pad, 12,12); ctx.fillStyle='rgba(255,255,255,.85)'; ctx.fillText('High‚Äë3 Pension', w-170, pad+10);
      ctx.fillStyle = '#60a5fa'; ctx.fillRect(w-190, pad+22, 12,12); ctx.fillStyle='rgba(255,255,255,.85)'; ctx.fillText('BRS Pension', w-170, pad+32);
      ctx.fillStyle = '#3ddc97'; ctx.fillRect(w-190, pad+44, 12,12); ctx.fillStyle='rgba(255,255,255,.85)'; ctx.fillText('DoD TSP (BRS)', w-170, pad+54);
    }

    // Refresh all charts on click
    document.getElementById('refresh-charts').addEventListener('click', ()=>{
      drawBasePayChart(bpGrade.value); drawCompChart(); drawRetChart();
    });

    // Initial draws
    drawBasePayChart('E-5'); drawCompChart(); drawRetChart();

    // Retirement calculators output
    document.getElementById('h3-calc').addEventListener('click', ()=>{
      const yos = +document.getElementById('h3-yos').value || 0;
      const high = +document.getElementById('h3-high').value || 0;
      const pct = 0.025 * yos; const monthly = pct * high;
      document.querySelector('#h3-result p').textContent = `‚âà ${Math.round(pct*100)}% of High‚Äë3 ‚Üí ~$${monthly.toLocaleString()}/mo (demo)`;
      drawRetChart();
    });
    document.getElementById('h3-yos').addEventListener('input', e=>{ document.getElementById('h3-yos-val').textContent = `YOS: ${e.target.value}`; });

    document.getElementById('brs-calc').addEventListener('click', ()=>{
      const yos = +document.getElementById('brs-yos').value || 0;
      const high = +document.getElementById('brs-high').value || 0;
      const memPct = Math.max(0, Math.min(15, +document.getElementById('brs-mem').value || 0));
      const base = +document.getElementById('brs-base').value || 0;
      const pension = 0.02 * yos * high;
      const dodPct = 0.01 + Math.min(0.04, memPct/100);
      const dodMonthly = base * dodPct;
      document.querySelector('#brs-result p').textContent = `Pension (demo): ~$${pension.toLocaleString()}/mo + DoD TSP est: ~$${dodMonthly.toLocaleString()}/mo`;
      document.getElementById('brs-mem-val').textContent = `Member TSP: ${memPct}%`;
      drawRetChart();
    });
  </script>
</body>
</html>
